Interval_4 = sum(Interval_4),
Interval_5 = sum(Interval_5),
Interval_6 = sum(Interval_6),
Interval_7 = sum(Interval_7),
Interval_8 = sum(Interval_8),
Interval_9 = sum(Interval_9),
Interval_10 = sum(Interval_10),
Interval_11 = sum(Interval_11),
Interval_12 = sum(Interval_12),
Interval_13 = sum(Interval_13),
Interval_14 = sum(Interval_14),
Interval_15 = sum(Interval_15),
Interval_16 = sum(Interval_16),
Interval_17 = sum(Interval_17),
Interval_18 = sum(Interval_18),
Interval_19 = sum(Interval_19),
Interval_20 = sum(Interval_20),
Interval_21 = sum(Interval_21),
Interval_22 = sum(Interval_22),
Interval_23 = sum(Interval_23),
Interval_24 = sum(Interval_24))
surveyData25 <-
surveyData25 %>%
group_by(site,dayOfYear,Start_Time, surveyYear) %>%
summarise(Interval_1 = sum(Interval_1), # this model wants summed # of birds per Interval_
Interval_2 = sum(Interval_2), # and has to match the distance data
Interval_3 = sum(Interval_3),
Interval_4 = sum(Interval_4),
Interval_5 = sum(Interval_5),
Interval_6 = sum(Interval_6),
Interval_7 = sum(Interval_7),
Interval_8 = sum(Interval_8),
Interval_9 = sum(Interval_9),
Interval_10 = sum(Interval_10),
Interval_11 = sum(Interval_11),
Interval_12 = sum(Interval_12))
#Combine all years
surveyDataAll <- bind_rows(surveyData23,surveyData24,surveyData25)
View(surveyDataAll)
# calculate sunrise times at Corvallis Airport on each survey date.
sunriseTimes <- getSunlightTimes(date = surveyDataAll$Count_Date, lat = 44.50, lon = -123.28,
keep = c("sunrise"), tz="America/Los_Angeles")
# 2023
surveyData23 <- read_csv("~/Documents/GitHub/hornedLarks/WV_SHLA_22_23.csv")
surveyData23 <-
surveyData23 %>%
select(unique_ID, Survey_Date,Survey_Time,Lark_ID, Interval_1, Interval_2,Interval_3,Interval_4)
surveyData23 <-
surveyData23 %>%
mutate(site = factor(unique_ID),
Lark_ID = factor(Lark_ID)) %>%
select(-unique_ID)
surveyData23$Count_Date <- mdy(surveyData23$Survey_Date)
surveyData23$Start_Time <- hms(surveyData23$Survey_Time)
surveyData23$dayOfYear <- yday(surveyData23$Count_Date) # create a day-of-year variable for analysis
surveyData23$surveyYear <- year(surveyData23$Count_Date)
surveyData23 <-
surveyData23 %>%
select(-Survey_Date, -Survey_Time)
surveyData23$Interval_1 <- ifelse(surveyData23$Interval_1 == "X", NA, surveyData23$Interval_1)
surveyData23$Interval_2 <- ifelse(surveyData23$Interval_2 == "X", NA, surveyData23$Interval_2)
surveyData23$Interval_3 <- ifelse(surveyData23$Interval_3 == "X", NA, surveyData23$Interval_3)
surveyData23$Interval_4 <- ifelse(surveyData23$Interval_4 == "X", NA, surveyData23$Interval_4)
surveyData23$Interval_1 <- factor(surveyData23$Interval_1, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData23$Interval_2 <- factor(surveyData23$Interval_2, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData23$Interval_3 <- factor(surveyData23$Interval_3, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData23$Interval_4 <- factor(surveyData23$Interval_4, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
## Add a "first detected by..." column to survey data:
surveyData23 <-
surveyData23 %>%
pivot_longer(., cols = 2:5, names_to = "interval", values_to = "detection") %>%
group_by(Lark_ID) %>%
filter(!is.na(detection)) %>%
summarise(firstDet = first(detection)) %>%
right_join(., surveyData23, by = 'Lark_ID', keep = F)
## Add a "first interval detected..." column to survey data:
surveyData23 <-
surveyData23 %>%
pivot_longer(., cols = 3:6, names_to = "interval", values_to = "detection") %>%
group_by(Lark_ID) %>%
filter(!is.na(detection)) %>%
summarise(firstDet = first(interval)) %>%
mutate(firstInterval = ifelse(firstDet == "Interval_1",1,
ifelse(firstDet == "Interval_2", 2,
ifelse(firstDet == "Interval_3", 3,
ifelse(firstDet == "Interval_4", 4, NA)))))%>%
right_join(., surveyData23, by = 'Lark_ID', keep = F) %>%
select(!(firstDet.x)) %>%
rename(firstDet = firstDet.y)
## Order the same as in the 24 and 25 data frames:
surveyData23 <-
surveyData23 %>%
select(Lark_ID,firstInterval,firstDet,site, Count_Date,
Start_Time,dayOfYear,surveyYear,Interval_1,Interval_2,
Interval_3, Interval_4)
# 2024
surveyData24 <- read_csv("~/Documents/GitHub/hornedLarks/WV_SHLA_2024_11.20.24.csv")
surveyData24 <-
surveyData24 %>%
select(unique_ID, OffRoad_ID, Survey_Date,Survey_Time,Lark_ID, Min_1,Min_2,Min_3,Min_4,Min_5,Min_6,
Min_7,Min_8,Min_9,Min_10,Min_11,Min_12,Min_13,Min_14,Min_15,Min_16,Min_17,Min_18,
Min_19,Min_20,Min_21,Min_22,Min_23,Min_24)
#Assign site identification, complicated by the use of OffRoad_ID as an equivalent of
#unique_ID for points not on roadside
surveyData24 <-
surveyData24 %>%
mutate(site = factor(ifelse(is.na(unique_ID),OffRoad_ID,unique_ID))) %>%
select(-OffRoad_ID,-unique_ID)
surveyData24$Count_Date <- mdy(surveyData24$Survey_Date)
surveyData24$Start_Time <- hms(surveyData24$Survey_Time)
surveyData24$dayOfYear <- yday(surveyData24$Count_Date) # create a day-of-year variable for analysis
surveyData24$surveyYear <- year(surveyData24$Count_Date)
surveyData24 <-
surveyData24 %>%
select(-Survey_Date, -Survey_Time)
surveyData24$Interval_1 <- ifelse(surveyData24$Min_1 == "X", NA, surveyData24$Min_1)
surveyData24$Interval_2 <- ifelse(surveyData24$Min_2 == "X", NA, surveyData24$Min_2)
surveyData24$Interval_3 <- ifelse(surveyData24$Min_3 == "X", NA, surveyData24$Min_3)
surveyData24$Interval_4 <- ifelse(surveyData24$Min_4 == "X", NA, surveyData24$Min_4)
surveyData24$Interval_5 <- ifelse(surveyData24$Min_5 == "X", NA, surveyData24$Min_5)
surveyData24$Interval_6 <- ifelse(surveyData24$Min_6 == "X", NA, surveyData24$Min_6)
surveyData24$Interval_7 <- ifelse(surveyData24$Min_7 == "X", NA, surveyData24$Min_7)
surveyData24$Interval_8 <- ifelse(surveyData24$Min_8 == "X", NA, surveyData24$Min_8)
surveyData24$Interval_9 <- ifelse(surveyData24$Min_9 == "X", NA, surveyData24$Min_9)
surveyData24$Interval_10 <- ifelse(surveyData24$Min_10 == "X", NA, surveyData24$Min_10)
surveyData24$Interval_11 <- ifelse(surveyData24$Min_11 == "X", NA, surveyData24$Min_11)
surveyData24$Interval_12 <- ifelse(surveyData24$Min_12 == "X", NA, surveyData24$Min_12)
surveyData24$Interval_13 <- ifelse(surveyData24$Min_13 == "X", NA, surveyData24$Min_13)
surveyData24$Interval_14 <- ifelse(surveyData24$Min_14 == "X", NA, surveyData24$Min_14)
surveyData24$Interval_15 <- ifelse(surveyData24$Min_15 == "X", NA, surveyData24$Min_15)
surveyData24$Interval_16 <- ifelse(surveyData24$Min_16 == "X", NA, surveyData24$Min_16)
surveyData24$Interval_17 <- ifelse(surveyData24$Min_17 == "X", NA, surveyData24$Min_17)
surveyData24$Interval_18 <- ifelse(surveyData24$Min_18 == "X", NA, surveyData24$Min_18)
surveyData24$Interval_19 <- ifelse(surveyData24$Min_19 == "X", NA, surveyData24$Min_19)
surveyData24$Interval_20 <- ifelse(surveyData24$Min_20 == "X", NA, surveyData24$Min_20)
surveyData24$Interval_21 <- ifelse(surveyData24$Min_21 == "X", NA, surveyData24$Min_21)
surveyData24$Interval_22 <- ifelse(surveyData24$Min_22 == "X", NA, surveyData24$Min_22)
surveyData24$Interval_23 <- ifelse(surveyData24$Min_23 == "X", NA, surveyData24$Min_23)
surveyData24$Interval_24 <- ifelse(surveyData24$Min_24 == "X", NA, surveyData24$Min_24)
surveyData24 <-
surveyData24 %>%
select(-Min_1,-Min_2,-Min_3, -Min_4,-Min_5,
-Min_6,-Min_7,-Min_8, -Min_9, -Min_10,
-Min_11, -Min_12, -Min_13, -Min_14,
-Min_15, -Min_16, -Min_17, -Min_18,
-Min_19, -Min_20, -Min_21, -Min_22,
-Min_23, -Min_24)
surveyData24$Interval_1 <- factor(surveyData24$Interval_1, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_2 <- factor(surveyData24$Interval_2, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_3 <- factor(surveyData24$Interval_3, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_4 <- factor(surveyData24$Interval_4, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_5 <- factor(surveyData24$Interval_5, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_6 <- factor(surveyData24$Interval_6, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_7 <- factor(surveyData24$Interval_7, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_8 <- factor(surveyData24$Interval_8, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_9 <- factor(surveyData24$Interval_9, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_10 <- factor(surveyData24$Interval_10, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_11 <- factor(surveyData24$Interval_11, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_12 <- factor(surveyData24$Interval_12, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_13 <- factor(surveyData24$Interval_13, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_14 <- factor(surveyData24$Interval_14, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_15 <- factor(surveyData24$Interval_15, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_16 <- factor(surveyData24$Interval_16, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_17 <- factor(surveyData24$Interval_17, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_18 <- factor(surveyData24$Interval_18, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_19 <- factor(surveyData24$Interval_19, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_20 <- factor(surveyData24$Interval_20, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_21 <- factor(surveyData24$Interval_21, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_22 <- factor(surveyData24$Interval_22, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_23 <- factor(surveyData24$Interval_23, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData24$Interval_24 <- factor(surveyData24$Interval_24, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
## Add a "first detected by..." column to survey data:
surveyData24 <-
surveyData24 %>%
pivot_longer(., cols = 7:30, names_to = "interval", values_to = "detection") %>%
group_by(Lark_ID) %>%
filter(!is.na(detection)) %>%
summarise(firstDet = first(detection)) %>%
right_join(., surveyData24, by = 'Lark_ID', keep = F)
## Add a "first interval detected..." column to survey data:
surveyData24 <-
surveyData24 %>%
pivot_longer(., cols = 8:31, names_to = "interval", values_to = "detection") %>%
group_by(Lark_ID) %>%
filter(!is.na(detection)) %>%
summarise(firstDet = first(interval)) %>%
mutate(firstInterval = ifelse(firstDet == "Interval_1",1,
ifelse(firstDet == "Interval_2", 2,
ifelse(firstDet == "Interval_3", 3,
ifelse(firstDet == "Interval_4", 4,
ifelse(firstDet == "Interval_5", 5,
ifelse(firstDet == "Interval_6", 6,
ifelse(firstDet == "Interval_7", 7,
ifelse(firstDet == "Interval_8", 8,
ifelse(firstDet == "Interval_9", 9,
ifelse(firstDet == "Interval_10", 10,
ifelse(firstDet == "Interval_11", 11,
ifelse(firstDet == "Interval_12", 12,
ifelse(firstDet == "Interval_13", 13,
ifelse(firstDet == "Interval_14", 14,
ifelse(firstDet == "Interval_15", 15,
ifelse(firstDet == "Interval_16", 16,
ifelse(firstDet == "Interval_17", 17,
ifelse(firstDet == "Interval_18", 18,
ifelse(firstDet == "Interval_19", 19,
ifelse(firstDet == "Interval_20", 20,
ifelse(firstDet == "Interval_21", 21,
ifelse(firstDet == "Interval_22", 22,
ifelse(firstDet == "Interval_23", 23,
ifelse(firstDet == "Interval_24", 24,NA)))))))))))))))))))))))))%>%
right_join(., surveyData24, by = 'Lark_ID', keep = F) %>%
select(!(firstDet.x)) %>%
rename(firstDet = firstDet.y)
#2025
## This file reads in with ~1000 extra rows, all blank, unless n_max is specified
surveyData25 <- read_csv("~/Documents/GitHub/hornedLarks/WV_SHLA_data_22_Sep_2025.csv",n_max = 159)
surveyData25 <-
surveyData25 %>%
select(unique_ID, Survey_Date,Survey_Time,Lark_ID, Min_1,Min_2,Min_3,Min_4,Min_5,Min_6,
Min_7,Min_8,Min_9,Min_10,Min_11,Min_12) %>%
mutate(site = factor(unique_ID)) %>%
select(-unique_ID)
surveyData25$Count_Date <- mdy(surveyData25$Survey_Date)
surveyData25$Start_Time <- hms(surveyData25$Survey_Time)
surveyData25$dayOfYear <- yday(surveyData25$Count_Date) # create a day-of-year variable for analysis
surveyData25$surveyYear <- year(surveyData25$Count_Date)
surveyData25 <-
surveyData25 %>%
select(-Survey_Date, -Survey_Time)
surveyData25$Interval_1 <- ifelse(surveyData25$Min_1 == "X", NA, surveyData25$Min_1)
surveyData25$Interval_2 <- ifelse(surveyData25$Min_2 == "X", NA, surveyData25$Min_2)
surveyData25$Interval_3 <- ifelse(surveyData25$Min_3 == "X", NA, surveyData25$Min_3)
surveyData25$Interval_4 <- ifelse(surveyData25$Min_4 == "X", NA, surveyData25$Min_4)
surveyData25$Interval_5 <- ifelse(surveyData25$Min_5 == "X", NA, surveyData25$Min_5)
surveyData25$Interval_6 <- ifelse(surveyData25$Min_6 == "X", NA, surveyData25$Min_6)
surveyData25$Interval_7 <- ifelse(surveyData25$Min_7 == "X", NA, surveyData25$Min_7)
surveyData25$Interval_8 <- ifelse(surveyData25$Min_8 == "X", NA, surveyData25$Min_8)
surveyData25$Interval_9 <- ifelse(surveyData25$Min_9 == "X", NA, surveyData25$Min_9)
surveyData25$Interval_10 <- ifelse(surveyData25$Min_10 == "X", NA, surveyData25$Min_10)
surveyData25$Interval_11 <- ifelse(surveyData25$Min_11 == "X", NA, surveyData25$Min_11)
surveyData25$Interval_12 <- ifelse(surveyData25$Min_12 == "X", NA, surveyData25$Min_12)
surveyData25 <-
surveyData25 %>%
select(-Min_1,-Min_2,-Min_3, -Min_4,-Min_5,
-Min_6,-Min_7,-Min_8, -Min_9, -Min_10,
-Min_11, -Min_12)
surveyData25$Interval_1 <- factor(surveyData25$Interval_1, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_2 <- factor(surveyData25$Interval_2, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_3 <- factor(surveyData25$Interval_3, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_4 <- factor(surveyData25$Interval_4, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_5 <- factor(surveyData25$Interval_5, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_6 <- factor(surveyData25$Interval_6, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_7 <- factor(surveyData25$Interval_7, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_8 <- factor(surveyData25$Interval_8, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_9 <- factor(surveyData25$Interval_9, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_10 <- factor(surveyData25$Interval_10, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_11 <- factor(surveyData25$Interval_11, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
surveyData25$Interval_12 <- factor(surveyData25$Interval_12, levels = c("C","S","V"), labels =
c("Calling", "Singing", "Visual"))
## Add a "first detected by..." column to survey data:
surveyData25 <-
surveyData25 %>%
pivot_longer(., cols = 7:18, names_to = "interval", values_to = "detection") %>%
group_by(Lark_ID) %>%
filter(!is.na(detection)) %>%
summarise(firstDet = first(detection)) %>%
right_join(., surveyData25, by = 'Lark_ID', keep = F)
## Add a "first interval detected..." column to survey data:
surveyData25 <-
surveyData25 %>%
pivot_longer(., cols = 8:19, names_to = "interval", values_to = "detection") %>%
group_by(Lark_ID) %>%
filter(!is.na(detection)) %>%
summarise(firstDet = first(interval)) %>%
mutate(firstInterval = ifelse(firstDet == "Interval_1",1,
ifelse(firstDet == "Interval_2", 2,
ifelse(firstDet == "Interval_3", 3,
ifelse(firstDet == "Interval_4", 4,
ifelse(firstDet == "Interval_5", 5,
ifelse(firstDet == "Interval_6", 6,
ifelse(firstDet == "Interval_7", 7,
ifelse(firstDet == "Interval_8", 8,
ifelse(firstDet == "Interval_9", 9,
ifelse(firstDet == "Interval_10", 10,
ifelse(firstDet == "Interval_11", 11,
ifelse(firstDet == "Interval_12", 12,NA)))))))))))))%>%
right_join(., surveyData25, by = 'Lark_ID', keep = F) %>%
select(!(firstDet.x)) %>%
rename(firstDet = firstDet.y)
#Encounter histories
## 2023
surveyData23 <-
surveyData23 %>%
mutate(Interval_1 = ifelse(firstInterval == 1, 1, 0),
Interval_2 = ifelse(firstInterval == 2, 1, 0),
Interval_3 = ifelse(firstInterval == 3, 1, 0),
Interval_4 = ifelse(firstInterval == 4, 1, 0))
### Change NA to zero for counts with no detections
#### 2023
surveyData23 <-
surveyData23 %>%
mutate(Interval_1 = ifelse(is.na(firstInterval == TRUE), 0, Interval_1),
Interval_2 = ifelse(is.na(firstInterval == TRUE), 0, Interval_2),
Interval_3 = ifelse(is.na(firstInterval == TRUE), 0, Interval_3),
Interval_4 = ifelse(is.na(firstInterval == TRUE), 0, Interval_4))
## 2024
surveyData24 <-
surveyData24 %>%
mutate(Interval_1 = ifelse(firstInterval == 1, 1, 0),
Interval_2 = ifelse(firstInterval == 2, 1, 0),
Interval_3 = ifelse(firstInterval == 3, 1, 0),
Interval_4 = ifelse(firstInterval == 4, 1, 0),
Interval_5 = ifelse(firstInterval == 5, 1, 0),
Interval_6 = ifelse(firstInterval == 6, 1, 0),
Interval_7 = ifelse(firstInterval == 7, 1, 0),
Interval_8 = ifelse(firstInterval == 8, 1, 0),
Interval_9 = ifelse(firstInterval == 9, 1, 0),
Interval_10 = ifelse(firstInterval == 10, 1, 0),
Interval_11 = ifelse(firstInterval == 11, 1, 0),
Interval_12 = ifelse(firstInterval == 12, 1, 0),
Interval_13 = ifelse(firstInterval == 13, 1, 0),
Interval_14 = ifelse(firstInterval == 14, 1, 0),
Interval_15 = ifelse(firstInterval == 15, 1, 0),
Interval_16 = ifelse(firstInterval == 16, 1, 0),
Interval_17 = ifelse(firstInterval == 17, 1, 0),
Interval_18 = ifelse(firstInterval == 18, 1, 0),
Interval_19 = ifelse(firstInterval == 19, 1, 0),
Interval_20 = ifelse(firstInterval == 20, 1, 0),
Interval_21 = ifelse(firstInterval == 21, 1, 0),
Interval_22 = ifelse(firstInterval == 22, 1, 0),
Interval_23 = ifelse(firstInterval == 23, 1, 0),
Interval_24 = ifelse(firstInterval == 24, 1, 0))
### Change NA to zero for counts without detections
surveyData24 <-
surveyData24 %>%
mutate(Interval_1 = ifelse(is.na(firstInterval == TRUE), 0, Interval_1),
Interval_2 = ifelse(is.na(firstInterval == TRUE), 0, Interval_2),
Interval_3 = ifelse(is.na(firstInterval == TRUE), 0, Interval_3),
Interval_4 = ifelse(is.na(firstInterval == TRUE), 0, Interval_4),
Interval_5 = ifelse(is.na(firstInterval == TRUE), 0, Interval_5),
Interval_6 = ifelse(is.na(firstInterval == TRUE), 0, Interval_6),
Interval_7 = ifelse(is.na(firstInterval == TRUE), 0, Interval_7),
Interval_8 = ifelse(is.na(firstInterval == TRUE), 0, Interval_8),
Interval_9 = ifelse(is.na(firstInterval == TRUE), 0, Interval_9),
Interval_10 = ifelse(is.na(firstInterval == TRUE), 0, Interval_10),
Interval_11 = ifelse(is.na(firstInterval == TRUE), 0, Interval_11),
Interval_12 = ifelse(is.na(firstInterval == TRUE), 0, Interval_12),
Interval_13 = ifelse(is.na(firstInterval == TRUE), 0, Interval_13),
Interval_14 = ifelse(is.na(firstInterval == TRUE), 0, Interval_14),
Interval_15 = ifelse(is.na(firstInterval == TRUE), 0, Interval_15),
Interval_16 = ifelse(is.na(firstInterval == TRUE), 0, Interval_16),
Interval_17 = ifelse(is.na(firstInterval == TRUE), 0, Interval_17),
Interval_18 = ifelse(is.na(firstInterval == TRUE), 0, Interval_18),
Interval_19 = ifelse(is.na(firstInterval == TRUE), 0, Interval_19),
Interval_20 = ifelse(is.na(firstInterval == TRUE), 0, Interval_20),
Interval_21 = ifelse(is.na(firstInterval == TRUE), 0, Interval_21),
Interval_22 = ifelse(is.na(firstInterval == TRUE), 0, Interval_22),
Interval_23 = ifelse(is.na(firstInterval == TRUE), 0, Interval_23),
Interval_24 = ifelse(is.na(firstInterval == TRUE), 0, Interval_24))
surveyData25 <-
surveyData25 %>%
mutate(Interval_1 = ifelse(firstInterval == 1, 1, 0),
Interval_2 = ifelse(firstInterval == 2, 1, 0),
Interval_3 = ifelse(firstInterval == 3, 1, 0),
Interval_4 = ifelse(firstInterval == 4, 1, 0),
Interval_5 = ifelse(firstInterval == 5, 1, 0),
Interval_6 = ifelse(firstInterval == 6, 1, 0),
Interval_7 = ifelse(firstInterval == 7, 1, 0),
Interval_8 = ifelse(firstInterval == 8, 1, 0),
Interval_9 = ifelse(firstInterval == 9, 1, 0),
Interval_10 = ifelse(firstInterval == 10, 1, 0),
Interval_11 = ifelse(firstInterval == 11, 1, 0),
Interval_12 = ifelse(firstInterval == 12, 1, 0))
View(surveyData23)
surveyData23 <-
surveyData23 %>%
group_by(site,Count_Date,dayOfYear,Start_Time, surveyYear) %>%
summarise(Interval_1 = sum(Interval_1), # this model wants summed # of birds per Interval_
Interval_2 = sum(Interval_2),
Interval_3 = sum(Interval_3),
Interval_4 = sum(Interval_4))
surveyData24 <-
surveyData24 %>%
group_by(site,dayOfYear,Count_Date,Start_Time, surveyYear) %>%
summarise(Interval_1 = sum(Interval_1), # this model wants summed # of birds per Interval_
Interval_2 = sum(Interval_2), # and has to match the distance data
Interval_3 = sum(Interval_3),
Interval_4 = sum(Interval_4),
Interval_5 = sum(Interval_5),
Interval_6 = sum(Interval_6),
Interval_7 = sum(Interval_7),
Interval_8 = sum(Interval_8),
Interval_9 = sum(Interval_9),
Interval_10 = sum(Interval_10),
Interval_11 = sum(Interval_11),
Interval_12 = sum(Interval_12),
Interval_13 = sum(Interval_13),
Interval_14 = sum(Interval_14),
Interval_15 = sum(Interval_15),
Interval_16 = sum(Interval_16),
Interval_17 = sum(Interval_17),
Interval_18 = sum(Interval_18),
Interval_19 = sum(Interval_19),
Interval_20 = sum(Interval_20),
Interval_21 = sum(Interval_21),
Interval_22 = sum(Interval_22),
Interval_23 = sum(Interval_23),
Interval_24 = sum(Interval_24))
surveyData25 <-
surveyData25 %>%
group_by(site,Count_Date,dayOfYear,Start_Time, surveyYear) %>%
summarise(Interval_1 = sum(Interval_1), # this model wants summed # of birds per Interval_
Interval_2 = sum(Interval_2), # and has to match the distance data
Interval_3 = sum(Interval_3),
Interval_4 = sum(Interval_4),
Interval_5 = sum(Interval_5),
Interval_6 = sum(Interval_6),
Interval_7 = sum(Interval_7),
Interval_8 = sum(Interval_8),
Interval_9 = sum(Interval_9),
Interval_10 = sum(Interval_10),
Interval_11 = sum(Interval_11),
Interval_12 = sum(Interval_12))
#Combine all years
surveyDataAll <- bind_rows(surveyData23,surveyData24,surveyData25)
# calculate sunrise times at Corvallis Airport on each survey date.
sunriseTimes <- getSunlightTimes(date = surveyDataAll$Count_Date, lat = 44.50, lon = -123.28,
keep = c("sunrise"), tz="America/Los_Angeles")
#create a new variable in surveyData that has sunrise matched to the survey point.
#careful, here, because there is no matching function (i.e., this only works if the
#two data frames are sorted in the same order. This should be the case unless you
#sort one after calling this function).
surveyData$sunrise <- sunriseTimes$sunrise
#create a new variable in surveyData that has sunrise matched to the survey point.
#careful, here, because there is no matching function (i.e., this only works if the
#two data frames are sorted in the same order. This should be the case unless you
#sort one after calling this function).
surveyDataAll$sunrise <- sunriseTimes$sunrise
#subtract the two times to get decimal hours after sunrise.
surveyDatAll$mas <- 60*((surveyData$Start_Time@hour + surveyData$Start_Time@minute/60) -
(hour(surveyData$sunrise) + minute(surveyData$sunrise)/60))
#subtract the two times to get decimal hours after sunrise.
surveyDatAll$mas <- 60*((surveyDataAll$Start_Time@hour + surveyDataAll$Start_Time@minute/60) -
(hour(surveyDataAll$sunrise) + minute(surveyDataAll$sunrise)/60))
#subtract the two times to get decimal hours after sunrise.
surveyDataAll$mas <- 60*((surveyDataAll$Start_Time@hour + surveyDataAll$Start_Time@minute/60) -
(hour(surveyDataAll$sunrise) + minute(surveyDataAll$sunrise)/60))
#clean up
rm(sunriseTimes)
View(surveyDataAll)
##Write file to CSV for easier import to reporting markdown:
write_csv(surveyDataAll, file = "/Users/johnlloyd/Documents/GitHub/hornedLarks/surveyDataAll.csv")
surveyData <- read.csv(file = "/Users/johnlloyd/Documents/GitHub/hornedLarks/surveyDataAll.csv",
header = TRUE,
sep = ",")
View(surveyDataAll)
surveyDataAll %>%
group_by(site, surveyYear, dayOfYear) %>%
summarise(site = first(site),
dayOfYear = first (dayOfYear),
mas = first(mas))
times_mat <- matrix(NA,822,24)
View(times_mat)
times_mat[1:573,1:4] <- 2
View(times_mat)
View(surveyData23)
times_mat[1:573,5:24] <- 0
View(times_mat)
View(surveyDataAll)
times_mat[574:682,1:24] <-1
times_mat[683:822,1:12] <- 1
times_mat[683:822,13:24] <- 0
View(times_mat)
